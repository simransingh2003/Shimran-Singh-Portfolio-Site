<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portfolio Admin Panel</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        * { scroll-behavior: smooth; }
        
        .admin-card {
            background: #1f2937;
            border: 1px solid #374151;
            border-radius: 0.5rem;
            padding: 1.5rem;
            transition: all 0.3s ease;
        }
        
        .admin-card:hover {
            border-color: #60a5fa;
            transform: translateY(-2px);
        }
        
        .btn-primary {
            background: #60a5fa;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 0.375rem;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        
        .btn-primary:hover {
            background: #3b82f6;
        }
        
        .btn-danger {
            background: #ef4444;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 0.375rem;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        
        .btn-danger:hover {
            background: #dc2626;
        }
        
        .btn-secondary {
            background: #6b7280;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 0.375rem;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        
        .btn-secondary:hover {
            background: #4b5563;
        }
        
        .input-field {
            width: 100%;
            padding: 0.75rem;
            background: #374151;
            border: 1px solid #4b5563;
            border-radius: 0.375rem;
            color: white;
            transition: all 0.3s ease;
        }
        
        .input-field:focus {
            outline: none;
            border-color: #60a5fa;
            background: #4b5563;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        
        .modal.active {
            display: flex;
        }
        
        .modal-content {
            background: #1f2937;
            padding: 2rem;
            border-radius: 1rem;
            max-width: 600px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .success-message {
            background: #10b981;
            color: white;
            padding: 1rem;
            border-radius: 0.5rem;
            margin-bottom: 1rem;
            display: none;
        }
        
        .success-message.active {
            display: block;
        }
    </style>
</head>
<body class="bg-gray-900 text-gray-100">
    
    <!-- Login Screen -->
    <div id="login-screen" class="min-h-screen flex items-center justify-center px-4">
        <div class="max-w-md w-full">
            <div class="admin-card">
                <h1 class="text-3xl font-bold mb-6 text-center gradient-text">üîê Portfolio Admin</h1>
                <form id="login-form" onsubmit="handleLogin(event)" class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium mb-2">Username</label>
                        <input type="text" id="username" class="input-field" placeholder="Enter username" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2">Password</label>
                        <input type="password" id="password" class="input-field" placeholder="Enter password" required>
                    </div>
                    <div id="login-error" class="text-red-500 text-sm hidden">Invalid credentials</div>
                    <button type="submit" class="btn-primary w-full">Login</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Admin Dashboard -->
    <div id="admin-dashboard" class="hidden">
        <!-- Header -->
        <nav class="bg-gray-800 border-b border-gray-700 sticky top-0 z-50">
            <div class="max-w-7xl mx-auto px-4 py-4 flex justify-between items-center">
                <h1 class="text-2xl font-bold">üìä Portfolio Dashboard</h1>
                <div class="flex gap-4">
                    <button onclick="exportData()" class="btn-secondary">üì• Export Data</button>
                    <button onclick="logout()" class="btn-danger">üö™ Logout</button>
                </div>
            </div>
        </nav>

        <!-- Success Message -->
        <div id="success-message" class="success-message max-w-7xl mx-auto mt-4 px-4">
            Changes saved successfully!
        </div>

        <!-- Dashboard Content -->
        <div class="max-w-7xl mx-auto px-4 py-8">
            
            <!-- Quick Stats -->
            <div class="grid md:grid-cols-4 gap-6 mb-8">
                <div class="admin-card text-center">
                    <div class="text-3xl font-bold text-blue-400" id="stat-achievements">0</div>
                    <div class="text-gray-400 mt-2">Achievements</div>
                </div>
                <div class="admin-card text-center">
                    <div class="text-3xl font-bold text-purple-400" id="stat-certificates">0</div>
                    <div class="text-gray-400 mt-2">Certificates</div>
                </div>
                <div class="admin-card text-center">
                    <div class="text-3xl font-bold text-green-400" id="stat-projects">5</div>
                    <div class="text-gray-400 mt-2">Projects</div>
                </div>
                <div class="admin-card text-center">
                    <div class="text-3xl font-bold text-yellow-400" id="stat-views">---</div>
                    <div class="text-gray-400 mt-2">Page Views</div>
                </div>
            </div>

            <!-- Tabs -->
            <div class="flex gap-4 mb-6 border-b border-gray-700">
                <button onclick="switchTab('metrics')" class="tab-btn px-4 py-2 text-blue-400 border-b-2 border-blue-400" data-tab="metrics">Impact Metrics</button>
                <button onclick="switchTab('achievements')" class="tab-btn px-4 py-2 hover:text-blue-400" data-tab="achievements">Achievements</button>
                <button onclick="switchTab('certificates')" class="tab-btn px-4 py-2 hover:text-blue-400" data-tab="certificates">Certificates</button>
                <button onclick="switchTab('settings')" class="tab-btn px-4 py-2 hover:text-blue-400" data-tab="settings">Settings</button>
            </div>

            <!-- Tab Content -->
            
            <!-- Metrics Tab -->
            <div id="tab-metrics" class="tab-content">
                <div class="admin-card">
                    <h2 class="text-2xl font-bold mb-6">üìà Impact Metrics</h2>
                    <form onsubmit="updateMetrics(event)" class="space-y-4">
                        <div class="grid md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium mb-2">Scan Time Reduced (%)</label>
                                <input type="number" id="metric-scan-time" class="input-field" placeholder="65" required>
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-2">False Positives Reduced (%)</label>
                                <input type="number" id="metric-false-positives" class="input-field" placeholder="40" required>
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-2">Members Led</label>
                                <input type="number" id="metric-members-led" class="input-field" placeholder="30" required>
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-2">Major Projects</label>
                                <input type="number" id="metric-projects" class="input-field" placeholder="5" required>
                            </div>
                        </div>
                        <button type="submit" class="btn-primary">Update Metrics</button>
                    </form>
                </div>
            </div>

            <!-- Achievements Tab -->
            <div id="tab-achievements" class="tab-content hidden">
                <div class="mb-6">
                    <button onclick="openAchievementModal()" class="btn-primary">+ Add New Achievement</button>
                </div>
                <div id="achievements-list" class="space-y-4">
                    <!-- Achievements will be loaded here -->
                </div>
            </div>

            <!-- Certificates Tab -->
            <div id="tab-certificates" class="tab-content hidden">
                <div class="mb-6">
                    <button onclick="openCertificateModal()" class="btn-primary">+ Add New Certificate</button>
                </div>
                <div id="certificates-list" class="grid md:grid-cols-2 gap-4">
                    <!-- Certificates will be loaded here -->
                </div>
            </div>

            <!-- Settings Tab -->
            <div id="tab-settings" class="tab-content hidden">
                <div class="admin-card">
                    <h2 class="text-2xl font-bold mb-6">‚öôÔ∏è Settings</h2>
                    <div class="space-y-6">
                        <div>
                            <h3 class="text-lg font-semibold mb-3">Change Password</h3>
                            <form onsubmit="changePassword(event)" class="space-y-4">
                                <div>
                                    <label class="block text-sm font-medium mb-2">New Password</label>
                                    <input type="password" id="new-password" class="input-field" placeholder="Enter new password" required>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium mb-2">Confirm Password</label>
                                    <input type="password" id="confirm-password" class="input-field" placeholder="Confirm new password" required>
                                </div>
                                <button type="submit" class="btn-primary">Change Password</button>
                            </form>
                        </div>
                        
                        <div class="border-t border-gray-700 pt-6">
                            <h3 class="text-lg font-semibold mb-3">Data Management</h3>
                            <div class="space-y-3">
                                <button onclick="exportData()" class="btn-secondary w-full md:w-auto">üì• Export All Data</button>
                                <button onclick="importData()" class="btn-secondary w-full md:w-auto ml-0 md:ml-3">üì§ Import Data</button>
                                <button onclick="resetData()" class="btn-danger w-full md:w-auto ml-0 md:ml-3">üîÑ Reset to Default</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <!-- Achievement Modal -->
    <div id="achievement-modal" class="modal">
        <div class="modal-content">
            <h2 class="text-2xl font-bold mb-6">Add/Edit Achievement</h2>
            <form onsubmit="saveAchievement(event)" class="space-y-4">
                <input type="hidden" id="achievement-id">
                <div>
                    <label class="block text-sm font-medium mb-2">Title</label>
                    <input type="text" id="achievement-title" class="input-field" placeholder="Achievement title" required>
                </div>
                <div>
                    <label class="block text-sm font-medium mb-2">Description</label>
                    <textarea id="achievement-description" class="input-field" rows="4" placeholder="Achievement description" required></textarea>
                </div>
                <div class="grid md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium mb-2">Date</label>
                        <input type="text" id="achievement-date" class="input-field" placeholder="e.g., 2024-2025" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2">Category</label>
                        <select id="achievement-category" class="input-field" required>
                            <option value="Technical">Technical</option>
                            <option value="Leadership">Leadership</option>
                            <option value="Media">Media</option>
                            <option value="Academic">Academic</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                </div>
                <div class="flex gap-3 justify-end">
                    <button type="button" onclick="closeAchievementModal()" class="btn-secondary">Cancel</button>
                    <button type="submit" class="btn-primary">Save Achievement</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Certificate Modal -->
    <div id="certificate-modal" class="modal">
        <div class="modal-content">
            <h2 class="text-2xl font-bold mb-6">Add/Edit Certificate</h2>
            <form onsubmit="saveCertificate(event)" class="space-y-4">
                <input type="hidden" id="certificate-id">
                <div>
                    <label class="block text-sm font-medium mb-2">Title</label>
                    <input type="text" id="certificate-title" class="input-field" placeholder="Certificate title" required>
                </div>
                <div>
                    <label class="block text-sm font-medium mb-2">Issuer</label>
                    <input type="text" id="certificate-issuer" class="input-field" placeholder="e.g., Deloitte, BCG" required>
                </div>
                <div>
                    <label class="block text-sm font-medium mb-2">Date</label>
                    <input type="text" id="certificate-date" class="input-field" placeholder="e.g., July 2025" required>
                </div>
                <div>
                    <label class="block text-sm font-medium mb-2">Link (Optional)</label>
                    <input type="url" id="certificate-link" class="input-field" placeholder="https://...">
                </div>
                <div>
                    <label class="block text-sm font-medium mb-2">Image URL (Optional)</label>
                    <input type="url" id="certificate-image" class="input-field" placeholder="https://...">
                    <p class="text-xs text-gray-400 mt-1">Use image hosting services or GitHub raw URLs</p>
                </div>
                <div class="flex gap-3 justify-end">
                    <button type="button" onclick="closeCertificateModal()" class="btn-secondary">Cancel</button>
                    <button type="submit" class="btn-primary">Save Certificate</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Include portfolio data management -->
    <script src="portfolio-data.js"></script>

    <!-- Admin Panel JavaScript -->
    <script>
        // Admin credentials (change these!)
        const ADMIN_USERNAME = "admin";
        const ADMIN_PASSWORD_HASH = hashPassword("shimran2025"); // Default password
        
        // Simple password hashing (NOT for production - use proper auth)
        function hashPassword(password) {
            return btoa(password); // Base64 encoding (simple obfuscation)
        }
        
        // Check if user is logged in
        function checkAuth() {
            const isLoggedIn = sessionStorage.getItem('adminLoggedIn');
            if (isLoggedIn === 'true') {
                showDashboard();
            }
        }
        
        // Handle login
        function handleLogin(event) {
            event.preventDefault();
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            const passwordHash = hashPassword(password);
            
            if (username === ADMIN_USERNAME && passwordHash === ADMIN_PASSWORD_HASH) {
                sessionStorage.setItem('adminLoggedIn', 'true');
                showDashboard();
                document.getElementById('login-error').classList.add('hidden');
            } else {
                document.getElementById('login-error').classList.remove('hidden');
            }
        }
        
        // Show dashboard
        function showDashboard() {
            document.getElementById('login-screen').classList.add('hidden');
            document.getElementById('admin-dashboard').classList.remove('hidden');
            loadDashboardData();
        }
        
        // Logout
        function logout() {
            sessionStorage.removeItem('adminLoggedIn');
            location.reload();
        }
        
        // Load dashboard data
        function loadDashboardData() {
            const data = portfolioData.getData();
            
            // Update stats
            document.getElementById('stat-achievements').textContent = data.achievements.length;
            document.getElementById('stat-certificates').textContent = data.certificates.length;
            
            // Load metrics
            const metrics = data.metrics;
            document.getElementById('metric-scan-time').value = metrics.scanTimeReduced;
            document.getElementById('metric-false-positives').value = metrics.falsePositivesReduced;
            document.getElementById('metric-members-led').value = metrics.membersLed;
            document.getElementById('metric-projects').value = metrics.majorProjects;
            
            // Load achievements and certificates
            loadAchievements();
            loadCertificates();
        }
        
        // Switch tabs
        function switchTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => tab.classList.add('hidden'));
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('text-blue-400', 'border-b-2', 'border-blue-400');
            });
            
            // Show selected tab
            document.getElementById(`tab-${tabName}`).classList.remove('hidden');
            document.querySelector(`[data-tab="${tabName}"]`).classList.add('text-blue-400', 'border-b-2', 'border-blue-400');
        }
        
        // Update metrics
        function updateMetrics(event) {
            event.preventDefault();
            const metrics = {
                scanTimeReduced: parseInt(document.getElementById('metric-scan-time').value),
                falsePositivesReduced: parseInt(document.getElementById('metric-false-positives').value),
                membersLed: parseInt(document.getElementById('metric-members-led').value),
                majorProjects: parseInt(document.getElementById('metric-projects').value)
            };
            portfolioData.updateMetrics(metrics);
            showSuccessMessage();
        }
        
        // Load achievements
        function loadAchievements() {
            const achievements = portfolioData.getAchievements();
            const container = document.getElementById('achievements-list');
            container.innerHTML = achievements.map(a => `
                <div class="admin-card">
                    <div class="flex justify-between items-start">
                        <div class="flex-1">
                            <h3 class="text-lg font-bold mb-2">${a.title}</h3>
                            <p class="text-gray-400 mb-2">${a.description}</p>
                            <div class="flex gap-4 text-sm">
                                <span class="text-blue-400">${a.date}</span>
                                <span class="px-2 py-1 bg-gray-700 rounded">${a.category}</span>
                            </div>
                        </div>
                        <div class="flex gap-2">
                            <button onclick="editAchievement(${a.id})" class="text-blue-400 hover:text-blue-300">‚úèÔ∏è</button>
                            <button onclick="deleteAchievementConfirm(${a.id})" class="text-red-400 hover:text-red-300">üóëÔ∏è</button>
                        </div>
                    </div>
                </div>
            `).join('');
        }
        
        // Load certificates
        function loadCertificates() {
            const certificates = portfolioData.getCertificates();
            const container = document.getElementById('certificates-list');
            container.innerHTML = certificates.map(c => `
                <div class="admin-card">
                    ${c.image ? `<img src="${c.image}" alt="${c.title}" class="w-full h-40 object-cover rounded mb-3">` : ''}
                    <h3 class="text-lg font-bold mb-2">${c.title}</h3>
                    <p class="text-gray-400 text-sm mb-2">${c.issuer}</p>
                    <p class="text-blue-400 text-sm mb-3">${c.date}</p>
                    <div class="flex gap-2">
                        <button onclick="editCertificate(${c.id})" class="btn-secondary text-sm">Edit</button>
                        <button onclick="deleteCertificateConfirm(${c.id})" class="btn-danger text-sm">Delete</button>
                    </div>
                </div>
            `).join('');
        }
        
        // Achievement modal functions
        function openAchievementModal() {
            document.getElementById('achievement-modal').classList.add('active');
            document.getElementById('achievement-id').value = '';
            document.getElementById('achievement-title').value = '';
            document.getElementById('achievement-description').value = '';
            document.getElementById('achievement-date').value = '';
            document.getElementById('achievement-category').value = 'Technical';
        }
        
        function closeAchievementModal() {
            document.getElementById('achievement-modal').classList.remove('active');
        }
        
        function saveAchievement(event) {
            event.preventDefault();
            const id = document.getElementById('achievement-id').value;
            const achievement = {
                title: document.getElementById('achievement-title').value,
                description: document.getElementById('achievement-description').value,
                date: document.getElementById('achievement-date').value,
                category: document.getElementById('achievement-category').value
            };
            
            if (id) {
                portfolioData.updateAchievement(parseInt(id), achievement);
            } else {
                portfolioData.addAchievement(achievement);
            }
            
            closeAchievementModal();
            loadAchievements();
            loadDashboardData();
            showSuccessMessage();
        }
        
        function editAchievement(id) {
            const achievements = portfolioData.getAchievements();
            const achievement = achievements.find(a => a.id === id);
            if (achievement) {
                document.getElementById('achievement-id').value = achievement.id;
                document.getElementById('achievement-title').value = achievement.title;
                document.getElementById('achievement-description').value = achievement.description;
                document.getElementById('achievement-date').value = achievement.date;
                document.getElementById('achievement-category').value = achievement.category;
                document.getElementById('achievement-modal').classList.add('active');
            }
        }
        
        function deleteAchievementConfirm(id) {
            if (confirm('Are you sure you want to delete this achievement?')) {
                portfolioData.deleteAchievement(id);
                loadAchievements();
                loadDashboardData();
                showSuccessMessage();
            }
        }
        
        // Certificate modal functions
        function openCertificateModal() {
            document.getElementById('certificate-modal').classList.add('active');
            document.getElementById('certificate-id').value = '';
            document.getElementById('certificate-title').value = '';
            document.getElementById('certificate-issuer').value = '';
            document.getElementById('certificate-date').value = '';
            document.getElementById('certificate-link').value = '';
            document.getElementById('certificate-image').value = '';
        }
        
        function closeCertificateModal() {
            document.getElementById('certificate-modal').classList.remove('active');
        }
        
        function saveCertificate(event) {
            event.preventDefault();
            const id = document.getElementById('certificate-id').value;
            const certificate = {
                title: document.getElementById('certificate-title').value,
                issuer: document.getElementById('certificate-issuer').value,
                date: document.getElementById('certificate-date').value,
                link: document.getElementById('certificate-link').value || '#',
                image: document.getElementById('certificate-image').value || 'https://via.placeholder.com/400x300?text=Certificate'
            };
            
            if (id) {
                portfolioData.updateCertificate(parseInt(id), certificate);
            } else {
                portfolioData.addCertificate(certificate);
            }
            
            closeCertificateModal();
            loadCertificates();
            loadDashboardData();
            showSuccessMessage();
        }
        
        function editCertificate(id) {
            const certificates = portfolioData.getCertificates();
            const certificate = certificates.find(c => c.id === id);
            if (certificate) {
                document.getElementById('certificate-id').value = certificate.id;
                document.getElementById('certificate-title').value = certificate.title;
                document.getElementById('certificate-issuer').value = certificate.issuer;
                document.getElementById('certificate-date').value = certificate.date;
                document.getElementById('certificate-link').value = certificate.link;
                document.getElementById('certificate-image').value = certificate.image;
                document.getElementById('certificate-modal').classList.add('active');
            }
        }
        
        function deleteCertificateConfirm(id) {
            if (confirm('Are you sure you want to delete this certificate?')) {
                portfolioData.deleteCertificate(id);
                loadCertificates();
                loadDashboardData();
                showSuccessMessage();
            }
        }
        
        // Export data
        function exportData() {
            const data = portfolioData.getData();
            const dataStr = JSON.stringify(data, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `portfolio-backup-${new Date().toISOString().split('T')[0]}.json`;
            link.click();
        }
        
        // Import data
        function importData() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            input.onchange = (e) => {
                const file = e.target.files[0];
                const reader = new FileReader();
                reader.onload = (event) => {
                    try {
                        const data = JSON.parse(event.target.result);
                        portfolioData.setData(data);
                        loadDashboardData();
                        showSuccessMessage();
                    } catch (error) {
                        alert('Error importing data. Please check the file format.');
                    }
                };
                reader.readAsText(file);
            };
            input.click();
        }
        
        // Reset data
        function resetData() {
            if (confirm('Are you sure you want to reset all data to default? This cannot be undone!')) {
                localStorage.removeItem('portfolioData');
                portfolioData.initializeData();
                loadDashboardData();
                showSuccessMessage();
            }
        }
        
        // Show success message
        function showSuccessMessage() {
            const message = document.getElementById('success-message');
            message.classList.add('active');
            setTimeout(() => message.classList.remove('active'), 3000);
        }
        
        // Change password
        function changePassword(event) {
            event.preventDefault();
            alert('Password change feature requires backend implementation. For now, edit the password directly in admin.html file.');
        }
        
        // Initialize
        checkAuth();
    </script>
</body>
</html>